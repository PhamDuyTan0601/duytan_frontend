{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{getPetsByUser,registerDevice,getMyDevices}from\"../api/api\";import Navbar from\"../components/Navbar\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function DeviceManagement(){const[pets,setPets]=useState([]);const[devices,setDevices]=useState([]);const[selectedPet,setSelectedPet]=useState(\"\");const[deviceId,setDeviceId]=useState(\"\");const[loading,setLoading]=useState(false);useEffect(()=>{fetchPets();fetchDevices();},[]);const fetchPets=async()=>{try{const res=await getPetsByUser();setPets(res.data.pets||[]);}catch(error){console.error(\"Error fetching pets:\",error);alert(\"Lá»—i khi táº£i danh sÃ¡ch pets\");}};const fetchDevices=async()=>{try{const res=await getMyDevices();setDevices(res.data.devices||[]);}catch(error){console.error(\"Error fetching devices:\",error);alert(\"Lá»—i khi táº£i danh sÃ¡ch devices\");}};const handleRegister=async e=>{e.preventDefault();if(!deviceId||!selectedPet){alert(\"Vui lÃ²ng nháº­p Device ID vÃ  chá»n pet\");return;}setLoading(true);try{await registerDevice(deviceId,selectedPet);alert(\"âœ… ÄÄƒng kÃ½ device thÃ nh cÃ´ng!\");setDeviceId(\"\");setSelectedPet(\"\");fetchDevices();}catch(error){var _error$response,_error$response$data;alert(\"âŒ Lá»—i Ä‘Äƒng kÃ½ device: \"+(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||\"Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh\"));}finally{setLoading(false);}};const generateDeviceId=()=>{const newId=\"ESP32_\"+Math.random().toString(36).substr(2,9).toUpperCase();setDeviceId(newId);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDCF1 Qu\\u1EA3n l\\xFD Devices\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u2795 \\u0110\\u0103ng k\\xFD Device M\\u1EDBi\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleRegister,children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:\"20px\"},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:\"block\",marginBottom:\"8px\",fontWeight:\"600\",color:\"#4a5568\"},children:\"Device ID:\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"10px\",marginBottom:\"5px\"},children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Nh\\u1EADp Device ID\",value:deviceId,onChange:e=>setDeviceId(e.target.value),style:{flex:1},required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:generateDeviceId,style:{marginBottom:0},children:\"\\uD83C\\uDFB2 T\\u1EA1o ID\"})]}),/*#__PURE__*/_jsx(\"small\",{style:{color:\"#718096\"},children:\"Device ID t\\u1EEB ESP32 ho\\u1EB7c t\\u1EA1o m\\u1EDBi\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:\"20px\"},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:\"block\",marginBottom:\"8px\",fontWeight:\"600\",color:\"#4a5568\"},children:\"Ch\\u1ECDn Pet:\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedPet,onChange:e=>setSelectedPet(e.target.value),required:true,style:{width:\"100%\",padding:\"12px\",border:\"2px solid #e2e8f0\",borderRadius:\"8px\"},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Ch\\u1ECDn pet --\"}),pets.map(pet=>/*#__PURE__*/_jsxs(\"option\",{value:pet._id,children:[pet.name,\" (\",pet.species,\")\"]},pet._id))]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,children:loading?\"Äang Ä‘Äƒng kÃ½...\":\"ðŸ“ ÄÄƒng kÃ½ Device\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCCB Devices \\u0110\\xE3 \\u0110\\u0103ng K\\xFD\"}),devices.length===0?/*#__PURE__*/_jsx(\"p\",{style:{textAlign:\"center\",color:\"#718096\",padding:\"20px\"},children:\"Ch\\u01B0a c\\xF3 device n\\xE0o \\u0111\\u01B0\\u1EE3c \\u0111\\u0103ng k\\xFD\"}):/*#__PURE__*/_jsx(\"div\",{className:\"devices-list\",children:devices.map(device=>{var _device$petId,_device$petId2;return/*#__PURE__*/_jsxs(\"div\",{className:\"device-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"device-info\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"Device ID: \",device.deviceId]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"pet-badge\",children:[\"Pet: \",((_device$petId=device.petId)===null||_device$petId===void 0?void 0:_device$petId.name)||\"Unknown\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"species-badge\",children:((_device$petId2=device.petId)===null||_device$petId2===void 0?void 0:_device$petId2.species)||\"Unknown\"})]}),/*#__PURE__*/_jsxs(\"small\",{children:[\"C\\u1EADp nh\\u1EADt:\",\" \",new Date(device.lastSeen).toLocaleString(\"vi-VN\")]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"device-status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"status \".concat(device.isActive?\"active\":\"inactive\"),children:device.isActive?\"ðŸŸ¢ Active\":\"ðŸ”´ Inactive\"})})]},device._id);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",style:{background:\"#f0f9ff\",borderLeft:\"4px solid #4299e1\"},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCD6 H\\u01B0\\u1EDBng D\\u1EABn S\\u1EED D\\u1EE5ng\"}),/*#__PURE__*/_jsxs(\"ol\",{style:{paddingLeft:\"20px\",marginBottom:\"20px\"},children:[/*#__PURE__*/_jsxs(\"li\",{style:{marginBottom:\"10px\"},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"T\\u1EA1o Device ID\"}),\" - Nh\\u1EA5n n\\xFAt \\\"T\\u1EA1o ID\\\" ho\\u1EB7c nh\\u1EADp ID t\\u1EEB ESP32\"]}),/*#__PURE__*/_jsxs(\"li\",{style:{marginBottom:\"10px\"},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Ch\\u1ECDn Pet\"}),\" - Ch\\u1ECDn pet m\\xE0 device s\\u1EBD theo d\\xF5i\"]}),/*#__PURE__*/_jsxs(\"li\",{style:{marginBottom:\"10px\"},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0110\\u0103ng k\\xFD\"}),\" - Nh\\u1EA5n \\\"\\u0110\\u0103ng k\\xFD Device\\\"\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"C\\u1EA5u h\\xECnh ESP32\"}),\" - D\\xF9ng Device ID trong code ESP32\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#e2e8f0\",padding:\"15px\",borderRadius:\"8px\"},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Code ESP32 m\\u1EABu:\"}),/*#__PURE__*/_jsxs(\"pre\",{style:{background:\"#2d3748\",color:\"#e2e8f0\",padding:\"10px\",borderRadius:\"6px\",marginTop:\"10px\",overflowX:\"auto\"},children:[\"String deviceId = \\\"\",deviceId||\"ESP32_ABC123XYZ\",\"\\\";\"]})]})]})]})]});}export default DeviceManagement;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}