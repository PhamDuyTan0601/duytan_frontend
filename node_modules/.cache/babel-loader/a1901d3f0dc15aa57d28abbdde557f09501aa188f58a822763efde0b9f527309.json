{"ast":null,"code":"import axios from \"axios\";\n\n// ===============================\n// üåê CONFIG\n// ===============================\nconst API_URL = process.env.REACT_APP_API_URL || \"https://pettracking2.onrender.com\";\n\n// ===============================\n// üë§ USER APIs\n// ===============================\n\n// ƒêƒÉng k√Ω t√†i kho·∫£n\nexport const registerUser = userData => axios.post(`${API_URL}/api/users/register`, userData);\n\n// ƒêƒÉng nh·∫≠p\nexport const loginUser = async userData => {\n  const response = await axios.post(`${API_URL}/api/users/login`, userData);\n  if (response.data.token) {\n    localStorage.setItem(\"token\", response.data.token);\n    localStorage.setItem(\"user\", JSON.stringify(response.data.user));\n  }\n  return response;\n};\n\n// ƒêƒÉng xu·∫•t\nexport const logoutUser = () => {\n  localStorage.removeItem(\"token\");\n  localStorage.removeItem(\"user\");\n};\n\n// ===============================\n// üêæ PET APIs\n// ===============================\n\n// Helper ƒë·ªÉ g·ª≠i token\nconst getAuthHeader = () => {\n  const token = localStorage.getItem(\"token\");\n  if (!token) {\n    throw new Error(\"No authentication token found!\");\n  }\n  return {\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  };\n};\n\n// L·∫•y danh s√°ch pet c·ªßa user hi·ªán t·∫°i\nexport const getPetsByUser = async () => axios.get(`${API_URL}/api/pets/my-pets`, getAuthHeader());\n\n// T·∫°o pet m·ªõi\nexport const addPet = async petData => axios.post(`${API_URL}/api/pets`, petData, getAuthHeader());\n\n// L·∫•y chi ti·∫øt 1 pet (ch·ªâ owner th·∫•y)\nexport const getPetById = async petId => axios.get(`${API_URL}/api/pets/${petId}`, getAuthHeader());\n\n// X√≥a pet\nexport const deletePet = async petId => axios.delete(`${API_URL}/api/pets/${petId}`, getAuthHeader());\n\n// ===============================\n// üìà PET DATA APIs\n// ===============================\nexport const getLatestPetData = async petId => axios.get(`${API_URL}/api/petData/pet/${petId}/latest`, getAuthHeader());\nexport const getAllPetData = async petId => axios.get(`${API_URL}/api/petData/pet/${petId}`, getAuthHeader());\n\n// ===============================\n// üì± DEVICE APIs\n// ===============================\n\n// ƒêƒÉng k√Ω device v·ªõi pet\nexport const registerDevice = async (deviceId, petId) => axios.post(`${API_URL}/api/devices/register`, {\n  deviceId,\n  petId\n}, getAuthHeader());\n\n// L·∫•y danh s√°ch devices c·ªßa user\nexport const getMyDevices = async () => axios.get(`${API_URL}/api/devices/my-devices`, getAuthHeader());\n\n// L·∫•y th√¥ng tin pet t·ª´ deviceId (cho ESP32)\nexport const getPetByDevice = async deviceId => axios.get(`${API_URL}/api/devices/pet/${deviceId}`);\n\n// ===============================\n// üß© AXIOS INTERCEPTOR\n// ===============================\naxios.interceptors.response.use(response => response, error => {\n  var _error$response;\n  if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n    console.warn(\"‚ö†Ô∏è Token expired or invalid. Logging out...\");\n    logoutUser();\n    window.location.href = \"/login\";\n  }\n  return Promise.reject(error);\n});","map":{"version":3,"names":["axios","API_URL","process","env","REACT_APP_API_URL","registerUser","userData","post","loginUser","response","data","token","localStorage","setItem","JSON","stringify","user","logoutUser","removeItem","getAuthHeader","getItem","Error","headers","Authorization","getPetsByUser","get","addPet","petData","getPetById","petId","deletePet","delete","getLatestPetData","getAllPetData","registerDevice","deviceId","getMyDevices","getPetByDevice","interceptors","use","error","_error$response","status","console","warn","window","location","href","Promise","reject"],"sources":["C:/Users/LENOVO/Downloads/front2/src/api/api.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\n// ===============================\r\n// üåê CONFIG\r\n// ===============================\r\nconst API_URL =\r\n  process.env.REACT_APP_API_URL || \"https://pettracking2.onrender.com\";\r\n\r\n// ===============================\r\n// üë§ USER APIs\r\n// ===============================\r\n\r\n// ƒêƒÉng k√Ω t√†i kho·∫£n\r\nexport const registerUser = (userData) =>\r\n  axios.post(`${API_URL}/api/users/register`, userData);\r\n\r\n// ƒêƒÉng nh·∫≠p\r\nexport const loginUser = async (userData) => {\r\n  const response = await axios.post(`${API_URL}/api/users/login`, userData);\r\n\r\n  if (response.data.token) {\r\n    localStorage.setItem(\"token\", response.data.token);\r\n    localStorage.setItem(\"user\", JSON.stringify(response.data.user));\r\n  }\r\n\r\n  return response;\r\n};\r\n\r\n// ƒêƒÉng xu·∫•t\r\nexport const logoutUser = () => {\r\n  localStorage.removeItem(\"token\");\r\n  localStorage.removeItem(\"user\");\r\n};\r\n\r\n// ===============================\r\n// üêæ PET APIs\r\n// ===============================\r\n\r\n// Helper ƒë·ªÉ g·ª≠i token\r\nconst getAuthHeader = () => {\r\n  const token = localStorage.getItem(\"token\");\r\n  if (!token) {\r\n    throw new Error(\"No authentication token found!\");\r\n  }\r\n  return {\r\n    headers: {\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n  };\r\n};\r\n\r\n// L·∫•y danh s√°ch pet c·ªßa user hi·ªán t·∫°i\r\nexport const getPetsByUser = async () =>\r\n  axios.get(`${API_URL}/api/pets/my-pets`, getAuthHeader());\r\n\r\n// T·∫°o pet m·ªõi\r\nexport const addPet = async (petData) =>\r\n  axios.post(`${API_URL}/api/pets`, petData, getAuthHeader());\r\n\r\n// L·∫•y chi ti·∫øt 1 pet (ch·ªâ owner th·∫•y)\r\nexport const getPetById = async (petId) =>\r\n  axios.get(`${API_URL}/api/pets/${petId}`, getAuthHeader());\r\n\r\n// X√≥a pet\r\nexport const deletePet = async (petId) =>\r\n  axios.delete(`${API_URL}/api/pets/${petId}`, getAuthHeader());\r\n\r\n// ===============================\r\n// üìà PET DATA APIs\r\n// ===============================\r\nexport const getLatestPetData = async (petId) =>\r\n  axios.get(`${API_URL}/api/petData/pet/${petId}/latest`, getAuthHeader());\r\n\r\nexport const getAllPetData = async (petId) =>\r\n  axios.get(`${API_URL}/api/petData/pet/${petId}`, getAuthHeader());\r\n\r\n// ===============================\r\n// üì± DEVICE APIs\r\n// ===============================\r\n\r\n// ƒêƒÉng k√Ω device v·ªõi pet\r\nexport const registerDevice = async (deviceId, petId) =>\r\n  axios.post(\r\n    `${API_URL}/api/devices/register`,\r\n    { deviceId, petId },\r\n    getAuthHeader()\r\n  );\r\n\r\n// L·∫•y danh s√°ch devices c·ªßa user\r\nexport const getMyDevices = async () =>\r\n  axios.get(`${API_URL}/api/devices/my-devices`, getAuthHeader());\r\n\r\n// L·∫•y th√¥ng tin pet t·ª´ deviceId (cho ESP32)\r\nexport const getPetByDevice = async (deviceId) =>\r\n  axios.get(`${API_URL}/api/devices/pet/${deviceId}`);\r\n\r\n// ===============================\r\n// üß© AXIOS INTERCEPTOR\r\n// ===============================\r\naxios.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    if (error.response?.status === 401) {\r\n      console.warn(\"‚ö†Ô∏è Token expired or invalid. Logging out...\");\r\n      logoutUser();\r\n      window.location.href = \"/login\";\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}